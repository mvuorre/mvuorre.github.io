---
title: "Glue your strings together"
description: |
  Use the glue R package to join strings.
author:
  - name: Matti Vuorre
    url: https://vuorre.netlify.com
    affiliation: University of Oxford
    affiliation_url: https://www.oii.ox.ac.uk/people/matti-vuorre/
    orcid_id: 0000-0001-5052-066X
date: 2018-12-12
categories:
  - data science
  - R
bibliography: bibliography.bib
base_url: https://mvuorre.github.io
output:
  distill::distill_article:
    self_contained: false
    toc: true
    toc_depth: 3
---

```{r setup, include = FALSE}
library(knitr)
library(tidyverse)
library(papaja)
opts_chunk$set(warning = F, message = F, eval = T, cache = T)
theme_set(theme_linedraw() + theme(panel.grid = element_blank()))
```

We've all been there; writing [manuscripts](https://github.com/crsh/papaja) with [R Markdown](https://rmarkdown.rstudio.com/) and dreaming of easy in-text code bits for reproducible reporting. Say you've fit a regression model to your data, and would then like to report the model's parameters in your text, without writing the values in the text. (If the data or model changes, you'd need to re-type the values again.)

For example, you can print this model summary easily in the R console:

```{r}
fit <- lm(mpg ~ disp, data = mtcars)
summary(fit)
```

And to cite those values in the text body of your manuscript, you can write the text in R Markdown like this:

```{r, eval = FALSE}
The model intercept was `r round(coef(fit)[1], 2)`, great.
```

Which would show up in your manuscript like this:

The model intercept was `r round(coef(fit)[1], 2)`, great.

## Paste

However, when you want to present more information, such as the parameter estimate with its standard error, you will have to `paste()` those strings together:

```{r}
(x <- round(summary(fit)$coefficients, 3))
intercept <- paste("b = ", x[1, 1], ", SE = ", x[1, 2], sep = "")
```

You can then just cite the `intercept` object in your text body:

```{r, eval = FALSE}
The model intercept was very very significant (`r intercept`).
```

Which would render in your PDF or word document as:

The model intercept was very very significant (`r intercept`).

`paste()` is a base R function, and as such very robust and reproducible--all R installations will have it. However, as such it has a fairly terrible syntax where you have to quote strings, separate strings and variables with commas, etc. This task is made much easier with `glue()`.

## Glue

[glue](https://glue.tidyverse.org/) is a small R package that allows you to join strings together in a neat, pythonific way. It replaces the need for quoting and separating arguments in `paste()`, by asking you to wrap variables in curly braces. Here's how to do the above pasting with glue:

```{r}
library(glue)
intercept <- glue("b = {x[1, 1]}, SE = {x[1, 2]}")
```

Which gives you the same string as the much messier `paste()` approach: `r intercept`

### Glue with data frames

Glue has other neat (more advanced) features, such as gluing variables row-by-row in a data frame:

```{r}
library(dplyr)
as.data.frame(x) %>% 
  glue_data(
    "{rownames(.)}'s point estimate was {Estimate}, with an SE of {`Std. Error`}."
  )
```

## Appendix: papaja

For some models (like our simple linear model example here), the [papaja R package](https://github.com/crsh/papaja) (which deserves its own rpihkal post!) has very useful shortcuts

```{r}
library(papaja)
intercept <- apa_print(fit)$estimate$Intercept
```

If you now cite `intercept` in the text body of your manuscript, it renders into $\LaTeX$ (which is interpreted nicely if you are outputting PDF or Word documents; here on this website it looks odd):

```{r, eval = FALSE}
The model intercept was rather significant (`r intercept`).
```

The model intercept was rather significant (`r intercept`).

Read more about glue at <https://glue.tidyverse.org/>.

<!-- Include at end of document -->

```{r child = here::here("meta.Rmd")}
# Include 'meta.Rmd' in root
```

### Software used {.appendix}

```{r cache = FALSE, include = FALSE}
papaja::r_refs("bibliography.bib")
```

The following software packages were used: `r papaja::cite_r("bibliography.bib")`.

<!-- Include at end of document -->
